<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Todo App</title>
</head>
<body>
  <h1>Todo App</h1>

  <form id="todoForm">
    <input type="text" id="todoText" placeholder="Enter todo..." required>
    <button type="submit">Add Todo</button>
  </form>

  <h2>Todo List</h2>
  <ul id="todoList"></ul>

  <script>
    const API_URL = 'https://todoapp-production-9f43.up.railway.app';

    // Fetch and display existing todos
    async function loadTodos() {
      try {
        const res = await fetch(`${API_URL}/todos`);
        const todos = await res.json();

        const list = document.getElementById("todoList");
        list.innerHTML = ""; // Clear current list

        todos.forEach(todo => {
          const li = document.createElement("li");
          li.textContent = todo.text + (todo.done ? " âœ…" : "");
          list.appendChild(li);
        });
      } catch (err) {
        console.error("Error loading todos:", err);
      }
    }

    // Handle new todo form
    document.getElementById("todoForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const input = document.getElementById("todoText");
      const newTodo = input.value.trim();

      if (newTodo) {
        try {
          await fetch(`${API_URL}/todos`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({ text: newTodo })
          });
          input.value = "";
          loadTodos(); // Refresh the list
        } catch (err) {
          console.error("Error adding todo:", err);
        }
      }
    });

    // Load todos when page loads
    loadTodos();
  </script>
</body>
</html>
